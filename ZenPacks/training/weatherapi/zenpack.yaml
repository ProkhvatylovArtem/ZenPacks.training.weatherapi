name: ZenPacks.training.weatherapi

zProperties:
  DEFAULTS:
    category: rapidapi weather

  zWeatherAPIHost:
    type: string
    default: 'weatherapi-com.p.rapidapi.com'

  zWeatherAPIKey:
    type: string
    default: '4767ff11ccmsh07e3f8226920ec0p1fb674jsn4711e7bb5020'

  zWeatherAPICities:
    type: lines
    default:
      - Lviv
      - Kiev
      - Kirovohrad

classes:
  WeatherAPIDevice:
    base: [ zenpacklib.Device ]
    label: rapidapi weather API

  WeatherAPILocation:
    base: [ zenpacklib.Component ]
    label: Location

    properties:
      country:
        label: Country

      lat:
        label: Latitude

      lon:
        label: Longitude

class_relationships:
  - WeatherAPIDevice 1:MC WeatherAPILocation

device_classes:
  /weatherapi:
    zProperties:
      zPythonClass: ZenPacks.training.weatherapi.WeatherAPIDevice
      zPingMonitorIgnore: true
      zSnmpMonitorIgnore: true
      zCollectorPlugins:
        - weatherapi.Locations

    templates:
      Location:
        description: Weather monitoring using the rapidapi.weather API.
        targetPythonClass: ZenPacks.training.weatherapi.WeatherAPILocation

        datasources:

          conditions:
            type: Python
            plugin_classname: ZenPacks.training.weatherapi.dsplugins.Conditions
            cycletime: "1800"

            datapoints:
              temp_c: GAUGE
              feelslike_c: GAUGE
              wind_kph: GAUGE
              humidity: GAUGE

        tresholds:
          WindWarning:
            dsnames: [conditions_wind_kph]
            eventClass: /Status
            severity: Warning
            minval: 0
            maxval: 61

        graphs:
          Temperature:
            units: "degrees C."
            graphpoints:
              Temperature:
                dpName: conditions_temp_c
                format: "%7.2lf"

          Wind:
            units: "kph"
            graphpoints:
              Wind:
                dpName: conditions_wind_kph
                format: "%7.2lf"

          Humidity:
            units: "%"
            graphpoints:
              Humidity:
                dpName: conditions_humidity
                format: "%7.2lf"